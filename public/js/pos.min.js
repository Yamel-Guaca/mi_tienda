function goToCategories(){window.location.href="pos.php?mode=tactil"}function goToCategory(e){window.location.href="pos.php?mode=tactil&cat="+e}function goToSubcategory(e,t){window.location.href="pos.php?mode=tactil&cat="+e+"&sub="+t}let cart=[];function addToCart(e,t,n,o,c=1){const r=cart.findIndex(t=>t.product_id===e);r>=0?cart[r].quantity+=c:cart.push({product_id:e,name:t,price:parseFloat(n),quantity:c,image:o}),renderCart(),playBeep()}function renderCart(){const e=document.getElementById("cart-body"),t=document.getElementById("total"),n=document.getElementById("items-input");if(!e||!t||!n)return;let o="",c=0;cart.forEach((e,t)=>{const n=e.price*e.quantity;c+=n,o+=`<tr><td>${e.name}</td><td>${e.quantity}</td><td>$${n.toFixed(2)}</td><td><button class="btn btn-danger" type="button" onclick="removeItem(${t})">X</button></td></tr>`}),e.innerHTML=o,t.innerText=c.toFixed(2),n.value=JSON.stringify(cart)}function removeItem(e){cart.splice(e,1),renderCart()}function clearCart(){cart.length&&confirm("Â¿Vaciar carrito?")&&(cart=[],renderCart())}let currentProduct=null;function openQtyModal(e,t,n,o){currentProduct={id:e,name:t,price:parseFloat(n),image:o};const c=document.getElementById("modal-overlay"),r=document.getElementById("modal-qty"),d=document.getElementById("modal-product-name");c&&r&&d&&(d.innerText=t,r.value=1,c.style.display="flex",r.focus())}function closeQtyModal(){const e=document.getElementById("modal-overlay");e&&(e.style.display="none"),currentProduct=null}function confirmQty(){const e=document.getElementById("modal-qty");if(!e||!currentProduct)return;const t=parseInt(e.value,10);t>0&&(addToCart(currentProduct.id,currentProduct.name,currentProduct.price,currentProduct.image,t),closeQtyModal())}function playBeep(){const e=document.getElementById("beep-sound");e&&(e.currentTime=0,e.play().catch(()=>{}))}const btnToggleDark=document.getElementById("btn-toggle-dark");btnToggleDark&&btnToggleDark.addEventListener("click",()=>{document.body.classList.toggle("dark"),btnToggleDark.textContent=document.body.classList.contains("dark")?"Modo claro":"Modo oscuro"}),document.addEventListener("keydown",function(e){const t=document.getElementById("modal-overlay"),n=t&&"flex"===t.style.display;if("Escape"===e.key&&n)return void closeQtyModal();if(n&&"Enter"===e.key)return e.preventDefault(),void confirmQty();if(!n){if("F1"===e.key){e.preventDefault();const t=document.getElementById("search-input");return void(t&&t.focus())}if("F2"===e.key){e.preventDefault();const t=document.getElementById("sell-form");return void(t&&t.submit())}"F3"===e.key&&(e.preventDefault(),clearCart())}});
